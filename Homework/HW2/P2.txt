# Problem 2
key_length==1, variance=0.00022710771795020877
key_length==2, variance=0.0002720715724378728
key_length==3, variance=0.000272265382155492
key_length==4, variance=0.0003436842630981825
key_length==5, variance=0.0003604488036722469
key_length==6, variance=0.0003609333279662951
key_length==7, variance=0.0014290671341953395
key_length==8, variance=0.0004411886245109935
key_length==9, variance=0.000432449113767795
Clearly, when key_length==7, we have a large population variance.
Then apply normal frequency analysis.
Assume letter 'e' will occur with top nth frequency and generate the possible key sets. In practice, we will make n=3 or n=4, since 3^7=2187, 4^7=16384, both affordable to use brute-force to try all keys.
So the final list of candidates are the following keys:
ANODIZE, ANODIVE, ANBDIZE, PNODIZE, ANRDIZE, ANODEZE
Print the decrypted text together with the population variance,
ANODIZE	0.0012245978821070398
thenaragornledthewayandsuchwasthestrengthofhiswillinthathourthatallthedunedainandtheirhorsesfollowedhimandindeedthelovethatthehorsesoftherangersborefortheirriderswassogreatthattheywerewillingtofaceeventheterrorofthedooriftheirmastersheartsweresteadyastheywalkedbesidethembutarodthehorseofrohanrefusedthewayandhestoodsweatingandtremblinginafearthatwasgrievoustoseethenlegolaslaidhishandsonhiseyesandsangsomewordsthatwentsoftinthegloomuntilhesufferedhimselftobeledandlegolaspassedinandtherestoodgimlithedwarfleftallalonehiskneesshookandhewaswrothwithhimselfhereisathingunheardofhesaidanelfwillgoundergroundandadwarfdarenotwiththatheplungedinbutitseemedtohimthathedraggedhisfeetlikeleadoverthethresholdandatonceablindnesscameuponhimevenupongimliglinssonwhohadwalkedunafraidinmanydeepplacesoftheworldaragornhadbroughttorchesfromdunharrowandnowhewentaheadbearingonealoftandelladanwithanotherwentattherearandgimlistumblingbehindstrovetoovertakehimhecouldseenothingbutthedimflameofthetorchesbutifthecompanyhaltedthereseemedanendlesswhisperofvoicesallabouthimamurmurofwordsinnotonguethathehadeverheardbeforenothingassailedthecompanynorwithstoodtheirpassageandyetsteadilyfeargrewonthedwarfashewentonmostofallbecauseheknewnowthattherecouldbenoturningbackallthepathsbehin
ANODIVE	0.0010522525907141296
thenavagornlidthewacandsuclwasthewtrengtlofhiswmllinthethourtlatalltledunedeinandtleirhorwesfollswedhimendindeidthelozethattlehorsewoftherengersbsrefortleirridirswasssgreattlattheyaerewilpingtofeceevenxheterrsrofthehooriftleirmasxersheavtswerewteadyawtheywapkedbesmdethemfutarodxhehorsiofroharrefusehthewayendhestsodsweaxingandxremblirginafeerthatwesgrievsustoseithenlekolaslamdhishardsonhiweyesanhsangsoqewordsxhatwenxsoftinxheglooquntilhisufferidhimsepftobelidandlekolaspawsedinardtherewtoodgiqlithedaarflefxallalorehiskniesshoooandheweswrothaithhimwelfheriisathirgunheavdofheseidaneljwillgoyndergrsundandedwarfderenotwmththatleplungidinbutmtseemehtohimtlathedreggedhiwfeetlioeleadozerthetlresholhandatorceablirdnesscemeuponlimevenypongimpiglinswonwhohedwalkehunaframdinmancdeepplecesoftleworlderagornladbroukhttorclesfromhunharrswandnoahewenteheadbeeringonialoftardelladenwitharotherwintatthirearanhgimlisxumblinkbehindwtrovetsovertaoehimhegouldseinothinkbutthehimflamiofthetsrchesbytifthegompanylaltedtlereseeqedanenhlesswhmsperofzoicesaplaboutlimamurqurofwovdsinnoxonguetlathehaheverheerdbefovenothirgassaipedthecsmpanynsrwithsxoodthemrpassakeandyexsteadipyfeargvewonthidwarfawhewentsnmostojallbeceusehekrewnowtlatthericouldbinoturnmngbackellthepethsbehmn
ANBDIZE	0.0010384921007631632
thrnaragoenledthrwayandfuchwasghestreagthofhvswilliathathohrthatayltheduaedainaadtheiruorsesfblloweduimandiadeedthrlovethntthehoesesoftuerangeesborefbrtheireiderswnssogrentthattueywerejillinggofaceeienthetrrrorofghedoorvftheirzastersueartswrresteaqyasthelwalkedoesidetuembutaeodthehbrseofrbhanrefhsedthejayandhrstoodsjeatingnndtremolinginnfearthntwasgrvevoustbseethealegolaflaidhifhandsoahiseyefandsantsomewoedsthatjentsofginthegyoomuntvlhesufseredhizselftooeledanqlegolafpassedvnandthrrestooqgimlituedwarfyeftallnlonehifkneessuookanduewaswrbthwithuimselfuereisaghingunueardofuesaidaaelfwilygoundeegroundnndadwaefdarenbtwithtuatheplhngedinoutitsermedtohvmthathrdraggeqhisfeeglikelendovertuethresuoldandntonceaolindnefscameuconhimeienupontimliglvnssonwuohadwaykedunasraidinzanydeecplacesbfthewoeldaragbrnhadbeoughttbrchesfeomdunhnrrowanqnowhewrntaheaqbearintonealostandelyadanwighanothrrwentagthereaeandgimyistumbyingbehvndstroietooveetakehizhecoulqseenotuingbutghedimfyameoftuetorchrsbutifghecompnnyhaltrdtherefeemedaaendlesfwhispeeofvoicrsallabbuthimazurmuroswordsianotonghethathrhadeveeheardbrforenoghingasfailedtuecompaaynorwighstoodgheirpafsageanqyetstendilyfenrgrewoathedwaefashewrntonmoftofalloecauseueknewnbwthattuerecouydbenothrningbnckalltuepathsoehin
PNODIZE	0.0010197894630129061
ehenararornledehewayaydsuchwlsthestcengthoqhiswilwinthatsourthaealltheounedaiyandthetrhorsedfollowpdhimanoindeedeheloveehatthesorsesoqtheranrersborpforthetrriderdwassogceatthaetheywecewilliygtofacpeventhpterrorzfthedozrifthetrmastecsheartdwerestpadyastseywalkpdbesidpthembuearodthphorseoqrohanrpfusedtsewayanohestooosweatiygandtrpmblingtnafearehatwasrrievoudtoseetsenlegowaslaidsishanddonhisejesandslngsomehordsthltwentszftinthpgloomuytilhesffferedsimselfeobeledlndlegowaspasspdinandeherestzodgimltthedwacfleftawlalonesiskneedshookaydhewashrothwiehhimsewfhereidathingfnheardzfhesaioanelfwtllgounoergrouydandadharfdarpnotwitsthathealungedtnbutitdeemedtzhimthaehedragredhisfpetlikeweadovecthethrpsholdaydatoncpablindyesscampuponhixevenupzngimlirlinssoywhohadhalkeduyafraidtnmanydpepplacpsofthehorldarlgornhaobroughetorchedfromduyharrowlndnowhpwentahpadbeartngoneawoftandplladanhithanoeherweneattherparandgtmlistuxblingbphindstcovetoogertakesimhecofldseenzthingbftthedixflameoqthetornhesbuttfthecoxpanyhawtedtheceseemeoanendlpsswhisaerofvotcesalllbouthixamurmucofworddinnotoyguethaehehadegerhearobeforeyothinglssaileothecomaanynorhithstozdtheiraassagelndyetseeadilyqeargrehonthedharfashpwentonxostofawlbecaudeheknehnowthaethereczuldbenzturninrbackalwthepatssbehin
ANRDIZE	0.0010135875520490905
thbnaragoonledthbwayandpuchwasqhestrekgthofhfswillikthathorrthatailthedukedainakdtheireorsesflllowedeimandikdeedthblovethxtthehoosesofteerangeosboreflrtheiroiderswxssogrextthatteeyweretillingqofaceesenthetbrrorofqhedoorfftheirjasterseeartswbresteaayasthevwalkedyesideteembutaoodthehlrseofrlhanrefrsedthetayandhbstoodsteatingxndtremylinginxfearthxtwasgrfevoustlseetheklegolaplaidhiphandsokhiseyepandsandsomewoodsthattentsofqinthegioomuntflhesufceredhijselftoyeledanalegolappassedfnandthbrestooagimliteedwarfieftallxlonehipkneesseookandeewaswrlthwitheimselfeereisaqhinguneeardofeesaidakelfwiligoundeogroundxndadwaofdarenltwithteatheplrngedinyutitsebmedtohfmthathbdraggeahisfeeqlikelexdoverteethreseoldandxtonceaylindnepscameumonhimesenupondimliglfnssonweohadwaikedunacraidinjanydeemplaceslfthewooldaraglrnhadbooughttlrchesfoomdunhxrrowananowhewbntaheaabearindonealoctandeliadanwiqhanothbrwentaqthereaoandgimiistumbiingbehfndstrosetooveotakehijhecoulaseenoteingbutqhedimfiameofteetorchbsbutifqhecompxnyhaltbdtherepeemedakendlespwhispeoofvoicbsallabluthimajurmurocwordsiknotongrethathbhadeveoheardbbforenoqhingaspailedteecompakynorwiqhstoodqheirpapsageanayetstexdilyfexrgrewokthedwaofashewbntonmoptofallyecauseeeknewnlwthatteerecouidbenotrrningbxckallteepathsyehin
ANODEZE	0.0010128607656080181
theneragornpedtheweyandsughwasthistrengxhofhisaillintlathourxhatallxhedunehainandxheirhovsesfolpowedhiqandindiedthelsvethatxhehorsisofthevangersforeforxheirriherswaswogreatxhatthecwerewiplingtojaceeverthetervorofthidoorifxheirmawtersheertsweristeadyestheywelkedbewidetheqbutarohthehorweofrohenrefusidthewacandhesxoodsweetinganhtremblmnginafiarthataasgriezoustosiethenligolasleidhishendsonhmseyesardsangssmewordwthatwertsoftirtheglosmuntillesuffevedhimsilftobepedandligolaspessedinendtheristoodgmmlithehwarflejtallalsnehiskreesshoskandheaaswrotlwithhiqselfheveisathmngunheerdofhewaidanepfwillgsundergvoundanhadwarfharenotaiththaxheplunkedinbuxitseemidtohimxhathedvaggedhmsfeetlmkeleadsverthexhreshopdandatsnceablmndnessgameuporhimeverupongiqliglinwsonwholadwalkidunafreidinmarydeepppacesofxheworlharagorrhadbroyghttorghesfroqdunharvowandnswhewenxaheadbiaringorealoftendellahanwithenotheraentattlerearardgimliwtumblirgbehinhstrovexoovertekehimhicouldsienothirgbutthidimflaqeofthexorchesfutifthicompanchaltedxhereseimedanerdlesswlisperojvoicesellabouxhimamuvmurofwsrdsinnstonguexhathehedeverhiardbefsrenothmngassamledthegompanyrorwithwtoodthiirpassegeandyitsteadmlyfearkrewontledwarfeshewenxonmostsfallbegauseheonewnowxhatthevecouldfenoturringbacoallthetathsbelin
It turns out that the plaintext decrypted by key 'ANODIZE' makes the most sense.